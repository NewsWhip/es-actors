#!/bin/bash

INDICES=(a-2014-2 a-2014-3 a-2014-4 a-2014-5 a-2014-6 a-2014-7 a-2014-8 a-2014-9 a-2014-10 a-2014-11 a-2014-12 a-2014-13 a-2014-14 a-2014-15 a-2014-16 a-2014-17 a-2014-18 a-2014-19 a-2014-20 a-2014-21 a-2014-22 a-2014-23 a-2014-24 a-2014-25 a-2014-26 a-2014-27 a-2014-28 a-2014-29 a-2014-30 a-2014-31 a-2014-32 a-2014-33 a-2014-34 a-2014-35 a-2014-36 a-2014-37 a-2014-38 a-2014-39 a-2014-40 a-2014-41 a-2014-42 a-2014-43 a-2014-44 a-2014-45 a-2014-46 a-2014-47 a-2014-48 a-2014-49 a-2014-50 a-2014-51 a-2014-52 a-2015-1 a-2015-2 a-2015-3 a-2015-4 a-2015-5 a-2015-6 a-2015-7 a-2015-8 a-2015-9 a-2015-10 a-2015-11 a-2015-12 a-2015-13 a-2015-14 a-2015-15 a-2015-16 a-2015-17 a-2015-18 a-2015-19 a-2015-20 a-2015-21 a-2015-22 a-2015-23 a-2015-24 a-2015-25 a-2015-26 a-2015-27 a-2015-28 a-2015-29 a-2015-30 a-2015-31 a-2015-32 a-2015-33 a-2015-34 a-2015-35 a-2015-36 a-2015-37 a-2015-38 a-2015-39 a-2015-40 a-2015-41 a-2015-42 a-2015-43 a-2015-44 a-2015-45 a-2015-46 a-2015-47 a-2015-48 a-2015-49 a-2015-50 a-2015-51 a-2015-52 a-2015-53 a-2016-1 a-2016-2 a-2016-3 a-2016-4 a-2016-5 a-2016-6 a-2016-7 a-2016-8 a-2016-9 a-2016-10 a-2016-11 a-2016-12 a-2016-13 a-2016-14 a-2016-15 a-2016-16 a-2016-17 a-2016-18 a-2016-19 a-2016-20 a-2016-21 a-2016-22 a-2016-23 a-2016-24 a-2016-25 a-2016-26 a-2016-27 a-2016-28 a-2016-29 a-2016-30 a-2016-31 a-2016-32 a-2016-33 a-2016-34 a-2016-35 a-2016-36 a-2016-37 a-2016-38 a-2016-39 a-2016-40 a-2016-41 a-2016-42 a-2016-43 a-2016-44 a-2016-45 a-2016-46 a-2016-47 a-2016-48 a-2016-49 a-2016-50 a-2016-51 a-2016-52 a-2017-1 a-2017-2 a-2017-3 a-2017-4 a-2017-5 a-2017-6 a-2017-7 a-2017-8 a-2017-9 a-2017-10 a-2017-11 a-2017-12 a-2017-13 a-2017-14 a-2017-15 a-2017-16)
BATCHSIZE=8

CLIENT_PROJECT="$1"
SOURCE_CLUSTER="NewsWhipCluster"
TARGET_CLUSTER="NewsWhipStagingCluster"
SOURCE_IPS="10.0.1.10,10.0.3.10,10.0.7.10,10.0.9.10"
TARGET_IPS="10.0.1.110,10.0.3.110,10.0.7.110,10.0.9.110,10.0.1.111"
TARGET_PORT="9300"

for((i=0; i < ${#INDICES[@]}; i+=BATCHSIZE))
do
  part=( "${INDICES[@]:i:BATCHSIZE}" )
  echo "Running transfer for ${part[*]}"
  sbt -J-Xmx25G -J-Xms25G "project client" "run --sourceCluster=$SOURCE_CLUSTER --targetCluster=$TARGET_CLUSTER --sources=$SOURCE_IPS --targets=$TARGET_IPS --indices=${part[*]}"
done